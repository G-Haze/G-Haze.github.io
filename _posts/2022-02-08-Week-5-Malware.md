## IoC Skills Bootcamp Week 5 - Malware

Malware analysis is the process of determining the function, origin and potential impact of a piece of malware (malicious software). When conducting malware analysis for incidence response it is important to consider the following:
- Point of Entry (PoE). How the file got onto the machine. Was it through opening an email attachment, inserting a USB or visiting a compromised website?
- Indicators that malware has been executed on the machine. Are there any files, processes or communication attempts that seem out of the ordinary?
- What the malware actually does. Does it attempt to infect other devices? Does it encrypt files or install a backdoor / Remote Access Tool (RAT)?
- How further infection can be detected and prevented.

Malware attacks can be generally classified into two types: **Targeted** and **Mass Campaign**. 
A targeted attack is one in which the malware has been created for a specific purpose against a specific target. An example of this could be the Stuxnet malware which was configured to only run on the targetted programmable logic controllers inside Natanz nuclear facility.
This differs from a Mass Campaign attack whose purpose is to infect as many devices as possible and perform it's function regardless of target. The WannaCry ransomware cryptoworm in May 2017 used the EternalBlue exploit and the DoublePulsar tool to infect over 230,000 Windows PCs across 150 countries in a single day.

Sometimes it can be fairly simple to decide if a piece of code is "malicious" from performing **Static Analysis**. This involves analysing the sample in the state it presents itself without executing the code. Metadata such as file name, type, and size can yield clues about the nature of the malware. MD5 checksums or hashes can be compared with a database to see if the malware has been previously recognised. Scanning a file with antivirus software may also reveal whether it is malicious or not. 

On the other hand, Dynamic Analysis is where the code is executed in a safe environment (usually a sandbox/virtual machine) in order to see how the system is modified by the code. Modifications may include new registry keys, IP addresses, domain names, and file path locations. It will also reveal whether the malware is communicating with a hacker’s external server. Debugging is another useful dynamic analysis technique. As the malware is running, a debugger can zero in on each step of the program’s behavior while the instructions are being processed.

While working through the [Malware Introductory](https://tryhackme.com/room/malmalintroductory) room on TryHackMe I had the opportunity to use the following tools:

Hashtab for obtaining the hash value of a file. I then looked up the values on [Virus Total](https://www.virustotal.com/gui/home/upload) to see whether they had been flagged as malicious.

PeID for identifying the compiler/packer of a file. Packing is a form of obfuscation which prevents decompiling of a program and makes it much harder to reverse engineer the code. This can be done for malicious or legitimate reasons such as protecting a program from being cracked and copied. PeID can be used to check whether the file's extension matches it's file headers which may be an indication of it being malicious. 

IDA Freeware to view the process flow of how a program executes. One of the characteristics that may signal a program has been packed is a small import count and very little showing in the flowchart. This may mean that malicious code has been hidden to remain undetected. 
