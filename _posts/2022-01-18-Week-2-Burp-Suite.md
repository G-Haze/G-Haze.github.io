## IoC Skills Bootcamp Week 2 - OWASP Juice Shop

Organisations often ask for a “vulnerability assessment” or a “penetration test” of their systems. A vulnerability assessment is a systematic approach to examining core assets and measuring whether they pose a threat to the organisation against a set of criteria. A penetration test is where an “attacker” will attempt to gain access to a system and document their process for achieving this.

This week we had a look at the OWASP Juice Shop. Every three to four years, [OWASP](https://owasp.org/) (Open Web Application Security Project) publish their Top 10 Web vulnerabilities and the Juice Shop exercise was designed to showcase these. These vulnerabilities are commonly found in real-world web applications and can vary in their complexity to execute. In particular, the Juice Shop is focused on Injection, Cross Site Scripting (XSS), Broken Authentication, Sensitive Data Exposure and Broken Access Control.

An injection flaw is a vulnerability which allows an attacker to relay malicious code through an application to another system. This can include compromising both backend systems as well as other clients connected to the vulnerable application. An SQL Injection is where an attacker enters a malicious or malformed SQL query to either retrieve or tamper with data from a database and sometimes log into accounts. I was able to perform this in the OWASP Juice Shop task using Burp Suite's Interceptor. Adding a simple statement to the http request on the login page `{"email":"' or 1=1--","password":"test"}` allowed me to log in to the account with user id 0 (the admin account in this case). This is because with the addition of `or 1=1` the email parameter will always return as true and the double dash `--` causes the server to disregard the password check.

Cross Site Scripting (XSS) is where malicious scripts are injected into otherwise benign and trusted websites. The scripts are then executed in other users browsers when they access the website/resource that was used in the attack. This type of vulnerability generally occurs when a web application uses input from a user within the output it generates without sanitising it.

There are three main types of XSS attacks;
Stored XSS attacks - where unsanitised user input is stored on the target servers and the victim then retrieves the malicious, injected script from the server when it requests the stored information. 
Reflected XSS attacks - occurs when a malicious script is reflected in the website’s results or HTTP response.
DOM XSS attacks (Document Object Model-based) - where the HTML environment is used to execute malicious javascript. This type of attack commonly uses the <script></script> HTML tag.

Broken Authentication attacks aim to take over one or more accounts giving the attacker the same privileges as the attacked user. Authentication is “broken” when attackers are able to compromise passwords, keys or session tokens, user account information, and other details to assume user identities. After spotting the admin's email address on one of the reviews I was able to use Burp Suite to brute-force their password. This didn't take too long using a Sniper Attack with one of the default wordlists. I was also able to reset another user's password using information left by them in their comments, from which I was able to answer their security question. This highlighted how any personal information posted on the internet, such as mentioning your favourite tv show character, could be potentially useful to an attacker.

Sensitive Data Exposure occurs when a web application, company, or other entity unknowingly exposes sensitive data. For example in the OWASP juice shop task I was able to access confidential documents as the library they were stored in was accessible to anyone. For security, the library only allowed `.md` and `.pdf` files to be downloaded
by its users. However, I was able to get around this by adding a **Poison Null Bytee** into the URL. Placing a null character before the file extension effectively tells the server to terminate the string at that point, therefore it is unable to check what type of file is being downloaded. This works as the validation check was only performed on the client side and not on the back end.

Access control is set up so that users cannot act outside of their intended permissions. This is broken if a user is able to perform a function outside their usual limits which could lead to unauthorised information disclosure, modification or destruction of data. There are two classifications of Broken Access Control exploits, Horizontal Privilege Escalation and Vertical Privilege Escalation. Horizontal Privilege Escalation occurs when a user can perform an action or access data of another user with the _same_ level of permissions. Whereas Vertical Privilege Escalation occurs when a user can perform an action or access data of another user with the _higher_ level of permissions, such as gaining access to an admin account.

Conclusion

I learnt about some common web application vulnerabilities and had a go at exploiting these within the OWASP Juice Shop. I was able to familiarise myself with some of the functionality of Burp Suite and gained some more experience brute-forcing account credentials as well as learning how to intercept and manipulate http requests.
